@require("./_ionicons")
@require("./_dejavu-sans-mono")
@require("./_syntax-highlighting")

/////////////////////////
///      COLORS       ///
/////////////////////////

primary = rgb(82, 160, 154)
secondary = rgb(77, 98, 192)
tertiary = rgb(101, 158, 140)

neutral = #f0f0f0
neutral-dark = rgb(20, 20, 20)


fixed-background()
  background-color: primary
  background-attachment: fixed, fixed, fixed
  background-image:
    url("/images/stripes.svg"),
    linear-gradient(
      45deg,
      transparentify(tertiary, 0.7) 7%,
      transparentify(primary, 0.7) 33%,
      transparentify(secondary, 0.7)
      ),
    url("/images/texture-block.png")
  background-size: cover, auto, auto


////////////////////////
///      MEDIA       ///
////////////////////////

media_queries = {
  mobile: "only screen and (max-width: 800px)",
  tablet: "only screen and (min-width: 801px) and (max-width: 1023px)",
  desktop: "only screen and (min-width: 1024px) and (max-width: 1439px)",
  wide: "only screen and (min-width: 1440px)"
}

for_breakpoint(breakpoints)
  conditions = ()
  for breakpoint in breakpoints
    push(conditions, media_queries[breakpoint])
  conditions = join(", ", conditions)
  @media conditions
    {block}

// Example usage:
//
//   +for_breakpoint(mobile tablet)
//     .hide-for-mobile
//       display none
//


/////////////////////////
///      STYLES       ///
/////////////////////////

*
  box-sizing: border-box

body
  font-family: "Dejavu Sans"
  font-weight: 200
  font-size: 20px

  display: flex
  align-items: center
  flex-direction: column

  fixed-background()

.header
  background-color: transparentify(neutral-dark, 0.7)
  color: neutral
  display: flex
  justify-content: center
  font-size: 0.7em
  letter-spacing: 2px
  text-transform: uppercase
  box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2)

  margin-bottom: 12px
  padding: 4px

  position: fixed
  z-index: 5
  top: 0
  width: 100%

  a
    padding: 8px 12px
    font-weight: 300
    font-size: 0.9em
    white-space: nowrap

h1, h2
  font-weight: 700
  line-height: 1.1

h1
  font-family: "Alegreya Sans SC"
  font-size: 64px
  letter-spacing: 4px

.repo-links
  display: block
  text-align: right
  font-size: 0.8em
  text-transform: none
  font-style: italic
  padding-right: 8px
  margin-top: -20px
  position: relative
  top: -36px

h2
  font-size: 36px

h3, h4
  font-weight: 400
  margin-top: 0
  padding-top: 12px

h3
  font-size: 28px

h4
  font-size: 22px

strong
  font-weight: 400

pre, code
  font-family: "Dejavu Sans Mono", "Menlo", monospace
  font-feature-settings: "liga" 0
  font-size: 0.9em
  line-height: initial

pre.diagram
  line-height: 1.3
  overflow-y: hidden
  text-align: center

p, ul, table
  margin: 0
  margin-bottom: 24px
  &:last-child
    margin-bottom: 0

a
  font-weight: 700
  color: inherit
  text-decoration: none
  cursor: pointer

thead
  font-weight: 400

td, tr
  padding: 4px 12px

.side-note
  display: flex
  margin: 16px 0
  align-items: center
  letter-spacing: 1px
  font-size: 0.9em

  .sigil
    font-size: 64px
    padding: 24px 48px

.container
  display: flex
  justify-content: center
  
  +for_breakpoint(mobile)
    margin-bottom: 24px

.full-page
  width: 100%
  color: neutral
  display: flex
  flex-direction: column
  align-items: center

  padding: 12px
  margin-top: 92px

  > *
    margin: 0

footer
  display: flex
  justify-content: center
  font-size: 0.7em

  padding: 64px  
  text-align: center

  color: neutral
  font-weight: 400

  p
    border-top-style: double
    padding: 16px 32px
    border-top-color: rgba(255, 255, 255, 0.3)


.landing
  padding: 64px

  text-align: center
  color: neutral

  margin-top: 48px

  +for_breakpoint(mobile)
    padding: 64px 0

  > *
    vertical-align: middle

  .logo-wrapper
    display: inline-block
    // Filter must be applied here and not on SVG, or the logo
    // will disappear in Safari.
    filter: drop-shadow(8px 8px 12px rgba(0, 0, 0, 0.4))

  .logo
    width: 160px

    path
      fill: neutral
    
  .landing-header
    display: inline-block
    text-shadow: 8px 8px 12px rgba(0, 0, 0, 0.4)

    +for_breakpoint(mobile)
      width: 100%
      display: flex
      flex-direction: column

    +for_breakpoint(tablet desktop wide)
      padding-left: 80px

    h1
      +for_breakpoint(mobile)
        font-size: 12vw
        margin: 4vh 0

    .subtitle
      margin-top: -46px
      font-size: 24px
      
      +for_breakpoint(mobile)
       margin-top: -40px

.cta
  display: inline-block
  padding: 8px 16px
  margin: 0 9px

  +for_breakpoint(mobile)
    margin-bottom: 6px

  border-style: solid
  border-width: 2px
  border-radius: 4px
  
  font-weight: 400
  font-size: 18px
  text-decoration: none
  color: inherit
  text-align: center

  user-select: none

  &:hover
    background-color: transparentify(neutral, 0.2)

body > section
  display: flex
  flex-direction: column
  padding: 24px 24px 48px 24px
  margin: 0

  +for_breakpoint(desktop wide)
    padding: 64px
    margin: auto
    margin-bottom: 0
    margin-top: 0

  > *
    display: inline-block

  h2
    text-align: center

  background-color: neutral
  color: neutral-dark
  
  &.glass 
    background-color: transparent
    color: neutral

  // Adjacent sections should be separated by some "glass".
  &:not(.glass) + section:not(.glass)
    margin-top: 32px;
  
  &.heading
    padding-bottom: 0

.content
  display: flex
  flex-direction: column

  +for_breakpoint(desktop wide)
    width: 800px

  font-size: 18px
  line-height: 28px

.split
  display: flex

  body > section > &
    +for_breakpoint(desktop)
      width: 800px
    
    +for_breakpoint(wide)
      min-width: 800px
      width: 1280px

  +for_breakpoint(mobile tablet desktop)
    flex-direction: column
    width: 80%
    margin: auto

  .block
    flex: 1 1 auto
    display: flex
    margin-right: 24px
    flex-direction: column
    justify-content: center

    p
      margin-top: 0

    +for_breakpoint(wide)
      flex: 0 1 auto

    &.fit
      margin-right: 0
      flex: 1 0 auto

      +for_breakpoint(mobile tablet desktop)
          display: flex
          justify-content: center
          align-items: center

#scroll-to-top
  position: fixed
  display: flex
  z-index: 2
  align-items: center
  justify-content: center

  color: white
  background-color: transparentify(neutral-dark, 0.5)
  font-size: 24px

  top: 60px
  right: calc(50vw - 24px)
  
  width: 48px
  height: 48px
  border-radius: 24px

  transition: opacity .25s ease-in-out
  opacity: 0

  i
    position: relative
    top: -2px

.module-system
  display: flex
  align-items: center

  aside
    flex: 0 1 400px
    margin-right: 64px

.bullet-points
  display: flex
  flex-direction: column
  flex-wrap: wrap

.bullet-point
  display: flex

  align-items: center
  justify-content: flex-start

  padding: 8px 22px
  margin: 4px
  text-align: center

  font-weight: inherit

  fixed-background()

  border-radius: 6px
  border-color: neutral
  border-width: 4px
  border-style: double

  color: neutral

  +for_breakpoint(mobile)
    padding: 48px
    flex-direction: column

  h3
    margin: 0 0 12px 0

  .illustration
    margin-right: 16px
    flex-shrink: 0

    +for_breakpoint(mobile)
      display: none

    svg
      width: 88px

  .description
    flex: 1 1 auto
    text-align: left

  .blurb
    font-size: 0.9em
    padding-bottom: 32px

  .more-info
    font-size: 24px
    margin: 0 24px
    
    +for_breakpoint(mobile)
      display: none

.glass
  text-shadow: 0 0 12px rgba(0, 0, 0, 0.4)

.console
  font-size: 12px
  background-color: rgba(30, 30, 30, 0.9)
  padding: 24px
  border-radius: 6px
  text-shadow: none
  color: neutral

  .glass &
    background-color: rgba(30, 30, 30, 0.4)

  &.standalone
    background-color: neutral-dark

  +for_breakpoint(mobile)
    max-width: 100%

.interactive-docs
  position: relative
  +for_breakpoint(desktop wide)
    width: 800px

  .status-bar-wrapper
    display: flex
    justify-content: space-between
    padding: 6px 12px
    background-color: neutral-dark
    color: white
    font-weight: 300
    font-size: 0.7em

  .status
    letter-spacing: 1px

  .visualization
    margin-bottom: -6px
    // `filter` would be valid here, but it performs poorly in Firefox.
    // Also, drop-shadow should not be applied directly to the svg
    // element, or it will disappear in Safari.
    -webkit-filter: drop-shadow(0 0 20px rgba(0, 0, 0, 0.4))
    
  .doc-wrapper
    padding: 48px
    
    h2
      margin: 0 0 8px 0
    
    th, td
      padding: 4px 12px

    table
      border-collapse: collapse
      font-size: 0.8em

    table td, table th
      border: 1px solid black

    table tr:first-child th
      border-top: 0

    table tr:last-child td
      border-bottom: 0

    table tr td:first-child,
    table tr th:first-child
      border-left: 0

    table tr td:last-child,
    table tr th:last-child
      border-right: 0

.interactive
  padding: 0

  +for_breakpoint(mobile tablet)
    width: 100%
    margin: 0

  +for_breakpoint(desktop)
    margin: 0 calc(12vw + (100vw - 1024px)/2.5)

  &.glass
    margin-top: 64px

  path.graph-arc:hover
    opacity: 0.5

  .doc-wrapper
    position: relative

  .breadcrumb
    position: absolute
    top: 6px
    left: 16px
    text-overflow: ellipsis
    white-space: nowrap
    overflow-x: hidden
    width: 95%

  .breadcrumb-item
    font-weight: 300
    font-size: 0.7em
    font-style: italic

  .breadcrumb-separator
    font-size: 0.6em
    margin: 0 6px 0 8px

#writing-a-plugin
  padding: 64px 0

  .console
    font-size: 20px

  +for_breakpoint(mobile)
    margin: 0
    .console
      font-size: 2.5vw

  +for_breakpoint(tablet)
    margin: 0 12vw
    .console
      font-size: 1.9vw

  +for_breakpoint(desktop)
    margin: 0 calc(12vw + (100vw - 1024px)/2.5)
    .console
      font-size: calc((64px + 1.3vw)/4.2)

.img-404
  border-style: solid
  border-color: neutral
  border-width: 8px
  margin: 8px 0
  
  max-width: 100%

.search-widget
  padding: 0 12px

.search-button
  font-size: 26px

.search-popup
  display: flex
  flex-direction: column

  position: fixed
  top: 0
  bottom: 0
  left: 0
  right: 0

  padding: 12vh 20vw

  background-color: rgba(0, 10, 20, 0.9)
  box-shadow: inset 0px 12px 12px -8px rgba(80, 80, 80, 0.4);


.search-bar
  border: none
  background-color: transparent
  color: white
  font-size: 28px
  padding: 16px
  
  border-style: dashed
  border-width: 1px
  border-color: rgba(255, 255, 255, 0.5)

.search-bar:focus
  outline: none

.search-results
  display: flex
  flex-direction: column
  padding: 16px

.search-results-more
  font-size: 24px

a.search-result
  display: flex
  flex-direction: column
  flex-shrink: 0
  padding: 8px 0

  &:hover,
  &.selected
    font-weight: 600
    text-shadow: 0 0 8px rgba(255, 255, 255, 0.7)

.search-result-title
  font-size: 17px
  letter-spacing: 3px

.search-result-context
  font-family: "Dejavu Sans"
  font-weight: 200
  text-transform: none
  letter-spacing: 1px
  font-size: 13px
  font-style: italic
  overflow: hidden

  .match
    font-weight: 600

.quick-start
  padding: 20px 32px
  border-style: solid
  border-width: 2px
  border-color: rgba(40, 40, 40, 0.7)  

  color: #fff;
  background-color: #52a09a;
  background-attachment: fixed, fixed, fixed;
  background-image: url("/images/stripes.svg"), -webkit-linear-gradient(45deg, rgba(35,116,91,0.7) 7%, rgba(8,119,111,0.7) 33%, rgba(1,31,165,0.7)), url("/images/texture-block.png");
  background-image: url("/images/stripes.svg"), linear-gradient(45deg, rgba(35,116,91,0.7) 7%, rgba(8,119,111,0.7) 33%, rgba(1,31,165,0.7)), url("/images/texture-block.png");
  background-size: cover, auto, auto;
  border-radius: 6px;
  border-color: #f0f0f0;
  border-width: 4px;
  border-style: double;

  input[type=checkbox]
    display: none

  input[type=checkbox] + label
    cursor: pointer
    display: inline-block
    padding: 8px 16px
    margin: 4px 9px 4px 0
    border-color: white
    border-style: solid
    border-width: 2px
    border-radius: 4px
    font-weight: 400
    font-size: 18px
    text-decoration: none
    color: inherit
    text-align: center
    user-select: none

  input[type=checkbox]:checked + label
    background-color: white
    color: #25716c
    border-color: #25716c

  input[type=text]
    border: 2px solid rgb(0, 0, 0)
    border-radius: 4px
    border-color: #25716c
    color: #25716c
    padding: 8px 14px

  .prompt
    margin-bottom: 12px
    
  .quick-start-section
    padding-top: 12px
    padding-bottom: 20px
    border-bottom-style: dotted
    border-bottom-width: 1px
    border-bottom-color: #25716c

  .quick-start-options
    border-left-color: #25716c
    border-left-style: solid
    border-left-width: 6px
    padding-left: 16px

  .download-wrapper
    display: flex
    justify-content: flex-end

    button
      background-color: white
      border-style: double
      border-width: 5px
      border-color: #25716c
      border-radius: 4px
      color: #25716c
      font-weight: 400
      padding: 8px 16px
      margin-top: 24px
